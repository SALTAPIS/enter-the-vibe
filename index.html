<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ENTER THE VIBE</title>
    
    <!-- Base Font Anton from Fontshare -->
    <link href="https://api.fontshare.com/v2/css?f[]=anton@400&display=swap" rel="stylesheet">
    
    <!-- Additional Fontshare Display Fonts for random variation -->
    <link href="https://api.fontshare.com/v2/css?f[]=clash-display@200,400,700,500,600,300&display=swap" rel="stylesheet">
    <link href="https://api.fontshare.com/v2/css?f[]=cabinet-grotesk@800,700,500,400,900,100,300,200,600&display=swap" rel="stylesheet">
    <link href="https://api.fontshare.com/v2/css?f[]=satoshi@900,700,500,300,400&display=swap" rel="stylesheet">
    <link href="https://api.fontshare.com/v2/css?f[]=general-sans@500,300,600,400,700&display=swap" rel="stylesheet">
    <link href="https://api.fontshare.com/v2/css?f[]=switzer@400,300,500,600,700&display=swap" rel="stylesheet">
    <link href="https://api.fontshare.com/v2/css?f[]=melodrama@700,400&display=swap" rel="stylesheet">
    <link href="https://api.fontshare.com/v2/css?f[]=tanker@700,400&display=swap" rel="stylesheet">
    
    <!-- React and ReactDOM from CDN -->
    <script src="https://unpkg.com/react@18.2.0/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.production.min.js" crossorigin></script>
    
    <!-- Include Babel for JSX transpilation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Import custom HeroUI components -->
    <script src="./src/heroui-init.js"></script>
    
    <link rel="stylesheet" href="./src/style.css">
</head>
<body>
    <!-- Audio Visualizer -->
    <canvas id="audio-visualizer" class="audio-visualizer"></canvas>
    
    <!-- Hero UI Controls Mount Point -->
    <div id="hero-panel-root"></div>
    
    <!-- Start Screen -->
    <div id="start-screen" class="phase">
        <div class="start-container">
            <h1 class="start-title">ENTER THE VIBE</h1>
            <button id="start-button">START EXPERIENCE</button>
        </div>
    </div>

    <!-- Phase 1: Optimized Credits Sequence -->
    <div id="phase1" class="phase hidden">
        <div class="cursor"></div>
        <div class="credits-container">
            <!-- Credits will be dynamically inserted here -->
        </div>
        <div class="single-credit-container">
            <!-- Single focused credits will appear here -->
        </div>
    </div>
    
    <!-- Phase 2: Main Title (Enter the Void style) -->
    <div id="phase2" class="phase hidden">
        <div class="title-container">
            <div class="title-word" id="title-enter">ENTER</div>
            <div class="title-word" id="title-the">THE</div>
            <div class="title-word" id="title-vibe">VIBE</div>
        </div>
    </div>
    
    <!-- Phase 3: Digital Landscape -->
    <div id="phase3" class="phase hidden">
        <div class="particles-container"></div>
        <div class="digital-landscape">
            <div class="grid"></div>
            <div class="sun"></div>
            <div class="vibe-coding">
                <span class="letter font-anton">V</span>
                <span class="letter font-anton">I</span>
                <span class="letter font-anton">B</span>
                <span class="letter font-anton">E</span>
                <span class="letter space">&nbsp;</span>
                <span class="letter font-anton">C</span>
                <span class="letter font-anton">O</span>
                <span class="letter font-anton">D</span>
                <span class="letter font-anton">I</span>
                <span class="letter font-anton">N</span>
                <span class="letter font-anton">G</span>
            </div>
        </div>
    </div>
    
    <!-- Audio Elements -->
    <audio id="main-sound" preload="auto">
        <source src="./sounds/Enter-the-Void.mp3" type="audio/mpeg">
    </audio>
    <audio id="glitch-sound" preload="auto">
        <source src="./sounds/glitch-sound.mp3" type="audio/mpeg">
    </audio>
    <audio id="transition-sound" preload="auto">
        <source src="./sounds/transition-sound.mp3" type="audio/mpeg">
    </audio>
    
    <!-- Frequency Range Highlight -->
    <div id="freq-range-highlight" class="freq-range-highlight"></div>
    
    <!-- Hero Panel Component -->
    <script type="text/babel">
        // Define the HeroPanel component
        const HeroPanel = ({
          peakThreshold,
          setPeakThreshold,
          noiseFloor,
          setNoiseFloor,
          freqRangeStart,
          setFreqRangeStart,
          freqRangeEnd,
          setFreqRangeEnd,
          autoBeats,
          setAutoBeats,
          beatInterval,
          setBeatInterval,
          displayTime,
          setDisplayTime,
          beatEnergy,
          cutoff,
          beatsDetected,
          onRestart,
          onReset,
          handleFreqRangeChange,
          visible,
          toggleVisibility,
          peakDetected
        }) => {
          // Create state for simplified view
          const [isSimplifiedView, setIsSimplifiedView] = React.useState(false);
          const [isActive, setIsActive] = React.useState(peakDetected || false);
          
          // Update the view mode when autoBeats changes
          React.useEffect(() => {
            setIsSimplifiedView(autoBeats);
          }, [autoBeats]);
          
          // Update active state when peakDetected changes
          React.useEffect(() => {
            setIsActive(peakDetected);
          }, [peakDetected]);
          
          // Get HeroUI components - we know they're available because they're loaded in heroui-init.js
          const { 
            Box, Card, CardHeader, CardBody, CardFooter, 
            Badge, Button, Flex, HStack, VStack, 
            Text, Switch, Select, Slider, Divider, 
            BeatIndicator, RangeSlider 
          } = window.HeroUI;
          
          // If not visible, just show the collapsed control
          if (!visible) {
            return (
              <Card
                width="50px"
                position="fixed"
                top="20px"
                right="20px"
                zIndex={10000}
              >
                <VStack p="10px" spacing={2} align="center">
                  <BeatIndicator active={isActive} />
                  <Button
                    onClick={toggleVisibility}
                    size="sm"
                    colorScheme="blue"
                  >
                    Show
                  </Button>
                </VStack>
              </Card>
            );
          }
          
          // Main control panel
          return (
            <Card
              width="300px"
              position="fixed"
              top="20px"
              right="20px"
              zIndex={10000}
              bg="rgba(0, 0, 0, 0.85)"
              borderColor="rgba(255, 255, 255, 0.2)"
              borderWidth="1px"
              boxShadow="0 0 10px rgba(0, 0, 0, 0.5)"
            >
              <CardHeader>
                <Flex justify="space-between" align="center">
                  <Text>Beat Controls</Text>
                  <Box ml="8px"><BeatIndicator active={isActive} /></Box>
                  <Box flex="1" />
                  <Button
                    onClick={toggleVisibility}
                    size="sm"
                    colorScheme="blue"
                  >
                    Hide
                  </Button>
                </Flex>
              </CardHeader>
              
              <CardBody>
                <VStack spacing={3} align="stretch">
                  <Box>
                    <Flex align="center" mb="4px">
                      <Text fontSize="14px">Peak Threshold: {typeof peakThreshold === 'number' ? peakThreshold.toFixed(2) : '0.05'}</Text>
                      <Box flex="1" />
                      <Badge colorScheme="blue">{typeof beatEnergy === 'number' ? Math.round(beatEnergy * 100) : 0}</Badge>
                    </Flex>
                    <Slider
                      min={0.01}
                      max={0.20}
                      step={0.01}
                      value={peakThreshold}
                      onChange={(e) => setPeakThreshold(parseFloat(e.target.value))}
                    />
                  </Box>
                  
                  <Box>
                    <Text fontSize="14px" mb="4px">Noise Floor: {noiseFloor}</Text>
                    <Slider
                      min={30}
                      max={150}
                      step={1}
                      value={noiseFloor}
                      onChange={(e) => setNoiseFloor(parseInt(e.target.value))}
                    />
                  </Box>
                  
                  <Box>
                    <Text fontSize="14px" mb="4px">Frequency Focus:</Text>
                    <Select
                      onChange={(e) => handleFreqRangeChange(e.target.value)}
                      value={
                        freqRangeStart === 0 && freqRangeEnd === 20 ? "bass" :
                        freqRangeStart === 10 && freqRangeEnd === 60 ? "mid" :
                        freqRangeStart === 50 && freqRangeEnd === 100 ? "high" :
                        freqRangeStart === 0 && freqRangeEnd === 120 ? "full" : "custom"
                      }
                    >
                      <option value="bass">Bass (Low)</option>
                      <option value="mid">Mids</option>
                      <option value="high">Highs</option>
                      <option value="full">Full Spectrum</option>
                      <option value="custom">Custom Range</option>
                    </Select>
                  </Box>
                  
                  {/* Only show the custom range controls in expanded view */}
                  {!isSimplifiedView && (
                    <Box>
                      <Flex justify="space-between" mb="4px">
                        <Text fontSize="12px">Start: {freqRangeStart}</Text>
                        <Text fontSize="12px">End: {freqRangeEnd}</Text>
                      </Flex>
                      <RangeSlider
                        minValue={freqRangeStart}
                        maxValue={freqRangeEnd}
                        minLimit={0}
                        maxLimit={120}
                        step={1}
                        onMinChange={setFreqRangeStart}
                        onMaxChange={setFreqRangeEnd}
                      />
                    </Box>
                  )}
                  
                  <Divider />
                  
                  <Flex align="center" justify="space-between">
                    <Text fontSize="14px">Auto Beats:</Text>
                    <Switch 
                      isChecked={autoBeats}
                      onChange={(e) => setAutoBeats(e.target.checked)}
                    />
                  </Flex>
                  
                  {autoBeats && (
                    <Box>
                      <Text fontSize="14px" mb="4px">Interval: {beatInterval}ms</Text>
                      <Slider
                        min={100}
                        max={1000}
                        step={50}
                        value={beatInterval}
                        onChange={(e) => setBeatInterval(parseInt(e.target.value))}
                      />
                    </Box>
                  )}
                  
                  <Box>
                    <Text fontSize="14px" mb="4px">Display Time: {(displayTime/1000).toFixed(1)}s</Text>
                    <Slider
                      min={100}
                      max={2000}
                      step={50}
                      value={displayTime}
                      onChange={(e) => setDisplayTime(parseInt(e.target.value))}
                    />
                  </Box>
                  
                  <Divider />
                  
                  {/* Debug Info */}
                  <Box fontSize="12px" color="rgba(255, 255, 255, 0.6)">
                    <Text>Energy: {typeof beatEnergy === 'number' ? beatEnergy.toFixed(2) : '0.00'}</Text>
                    <Text>Cutoff: {typeof cutoff === 'number' ? cutoff.toFixed(2) : '0.00'}</Text>
                    <Text>Beats: {beatsDetected}</Text>
                  </Box>
                </VStack>
              </CardBody>
            </Card>
          );
        };
        
        // Make it globally available
        window.HeroPanel = HeroPanel;
    </script>
    
    <!-- Main Script -->
    <script type="module" src="./src/script.js"></script>
</body>
</html> 